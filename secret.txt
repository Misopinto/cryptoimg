Skip to content
geeksforgeeks
Tutorials
DSA
Data Science
Web Tech
Courses


Sign In

Python Basics
Interview Questions
Python Quiz
Popular Packages
Python Projects
Practice Python
AI With Python
Learn Python3
Python Automation
Python Web Dev
DSA with Python
Python OOPs
Lists
Strings
Dictionaries

NumPy Tutorial - Python Library
Introduction
Creating NumPy Array
NumPy Array Manipulation
Matrix in NumPy
Operations on NumPy Array
Reshaping NumPy Array
Indexing NumPy Array
Arithmetic operations on NumPyArray
Linear Algebra in NumPy Array
NumPy and Random Data
Sorting and Searching in NumPy Array
Universal Functions
Working With Images
Create a white image using NumPy in Python
Convert a NumPy array to an image
How to Convert images to NumPy array?
How to Convert an image to NumPy array and saveit to CSV file using Python?
Projects and Applications with NumPy
How to Convert images to NumPy array?
Last Updated : 30 Sep, 2022
Images are an easier way to represent the working model. In Machine Learning, Python uses the image data in the format of Height, Width, Channel format. i.e. Images are converted into Numpy Array in Height, Width, Channel format.  In this article we will see How to Convert images to NumPy array?

Modules Needed:
NumPy: By default in higher versions of Python like 3.x onwards, NumPy is available and if not  available(in lower versions), one can install by using
pip install numpy

Pillow: This has to be explicitly installed in later versions too. It is a preferred image manipulation tool. In Python 3, Pillow python library which is nothing but the upgradation of PIL only. It can be installed using
pip install Pillow

Loading the images via Pillow Library
Let us check for an image that is in the PNG or JPEG format. The image can be referred via its path. Image class is the heart of PIL. It has open() function which opens up an image and digital file format can be retrieved as well as pixel format.

Image Used:


 

Python3
from PIL import Image
image = Image.open('Sample.png')
 
# summarize some details about the image
print(image.format)
print(image.size)
print(image.mode)
Output :

PNG
(400, 200)
RGB
Converting an image into NumPy Array
Python provides many modules and API’s for converting an image into a NumPy array. Let’s discuss to Convert images to NumPy array in Python.

Using NumPy module to Convert images to NumPy array
Numpy module in itself provides various methods to do the same. These methods are – 

Example 1:Using asarray() function
asarray() function is used to convert PIL images into NumPy arrays. This function converts the input to an array

Python3
# Import the necessary libraries
from PIL import Image
from numpy import asarray
 
 
# load the image and convert into
# numpy array
img = Image.open('Sample.png')
 
# asarray() class is used to convert
# PIL images into NumPy arrays
numpydata = asarray(img)
 
# <class 'numpy.ndarray'>
print(type(numpydata))
 
#  shape
print(numpydata.shape)
Output :

<class 'numpy.ndarray'>
(200, 400, 3)
Example 2: Using numpy.array() function
By using numpy.array() function which takes an image as the argument and converts to NumPy array

Python3
from PIL import Image
import numpy
 
 
img= Image.open("Sample.png")
np_img = numpy.array(img)
 
print(np_img.shape)
Output :

(200, 400, 3)
In order to get the value of each pixel of the NumPy array image, we need to print the retrieved data that got either from asarray() function or array() function.


Python3
# Import the necessary libraries
from PIL import Image
from numpy import asarray
 
 
# load the image and convert into 
# numpy array
img = Image.open('Sample.png')
numpydata = asarray(img)
 
# data
print(numpydata)
Output :

[[[111  60   0]
 [116  65   0]
 [122  69   0]
 ...
 [ 97  47   0]
 [ 99  47   0]
 [100  49   0]]
[[111  61   0]
 [118  65   0]
 [122  69   0]
 ...
 [ 97  47   0]
 [ 99  48   0]
 [100  49   0]]
[[118  65   0]
 [122  69   0]
 [126  73   3]
 ...
 [ 98  48   0]
 [100  49   0]
 [100  49   0]]
...
[[ 96  44   7]
 [ 95  43   6]
 [ 93  41   4]
 ...
 [225  80   3]
 [228  80   0]
 [229  78   0]]
[[ 93  40   6]
 [ 90  37   5]
 [ 85  32   0]
 ...
 [226  81   4]
 [231  80   1]
 [232  79   1]]
[[ 89  36   4]
 [ 84  31   0]
 [ 79  26   0]
 ...
 [228  81   4]
 [232  81   4]
 [233  80   2]]]
Getting back the image from converted Numpy Array
Image.fromarray() function helps to get back the image from converted numpy array. We get back the pixels also same after converting back and forth. Hence, this is very much efficient

Python3
img = Image.open('Sample.png')
numpydata = asarray(img)
 
print(type(numpydata))
 
#  shape
print(numpydata.shape)
 
# Below is the way of creating Pillow 
# image from our numpyarray
pilImage = Image.fromarray(numpydata)
print(type(pilImage))
 
# Let us check  image details
print(pilImage.mode)
print(pilImage.size)
Output :

<class 'numpy.ndarray'>
(200, 400, 3)
<class 'PIL.Image.Image'>
RGB
(400, 200)
Using Keras API  to Convert images to NumPy array
Keras API provides the functions for loading, converting, and saving image data. Keras is possible to run on the top of the TensorFlow framework and hence that is mandatory to have. Deep learning computer vision images require Keras API. To install it type the below command in the terminal 

pip install keras

As Keras requires TensorFlow 2.2 or higher. If not there, need to install it. To install it type the below command in the terminal.

pip install tensorflow

Python3
from keras.preprocessing.image import load_img
import warnings
 
# load the image via load_img 
# function
img = load_img('sample.png')
 
# details about the image printed below
print(type(img)) 
print(img.format)
print(img.mode)
print(img.size)
Output :

<class 'PIL.PngImagePlugin.PngImageFile'>
PNG
RGB
(400, 200)
Using Keras API, convert images to Numpy Array and reverting the image from Numpy Array

Python3
from keras.preprocessing.image import img_to_array
from keras.preprocessing.image import array_to_img
 
# details about the image printed below
print(type(img))
print(img.format)
print(img.mode)
print(img.size)
 
# convert the given image into  numpy array
img_numpy_array = img_to_array(img)
print("Image is converted and NumPy array information :")
 
# <class 'numpy.ndarray'>
print(type(img_numpy_array))
 
# type: float32
print("type:", img_numpy_array.dtype)
 
# shape: (200, 400, 3)
print("shape:", img_numpy_array.shape)
 
# convert back to image
img_pil_from_numpy_array = array_to_img(img_numpy_array)
 
# <class 'PIL.PngImagePlugin.PngImageFile'>
print("converting NumPy array into image:",
      type(img_pil_from_numpy_array))
Output :

<class 'PIL.PngImagePlugin.PngImageFile'>
PNG
RGB
(400, 200)
Image is converted and NumPy array information :
<class 'numpy.ndarray'>
type: float32
shape: (200, 400, 3)
converting NumPy array into image: <class 'PIL.Image.Image'>
From the above output, we can check that the source image PIL.Image.Image and destination image types are the same.

Using OpenCV Library to Convert images to NumPy array
OpenCV version from 3.x has DNN and Caffe frameworks, and they are very helpful to solve deep learning problems. It can be installed by using

pip install opencv-contrib-python

cv2 package has the following methods

imread() function is used to load the image and It also reads the given image (PIL image) in the NumPy array format. 
Then we need to convert the image color from BGR to RGB. 
imwrite() is used to save the image in the file.
Python3
import cv2
 
image = cv2.imread('Sample.png')
 
# BGR -> RGB
img = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
 
cv2.imwrite('opncv_sample.png', img) 
print (type(img))
Output :

<class 'numpy.ndarray'>
Conclusion
Python is a very flexible tool and we have seen ways of converting images into Numpy Array and similarly back to images using different APIs. Manipulating the converted array and forming different image data and one can feed into deep learning neural networks.



author
priyarajtt

18
Previous Article
Convert a NumPy array to an image
Next Article
How to Convert an image to NumPy array and saveit to CSV file using Python?
Similar Reads
NumPy ndarray.tolist() Method | Convert NumPy Array to List
The ndarray.tolist() method converts a NumPy array into a nested Python list. It returns the array as an a.ndim-levels deep nested list of Python scalars. Data items are converted to the nearest compatible built-in Python type. Example C/C++ Code import numpy as np gfg = np.array([1, 2, 3, 4, 5]) print(gfg.tolist()) Output[1, 2, 3, 4, 5] SyntaxSynt
1 min read
Arithmetic Operations on Images using OpenCV | Set-2 (Bitwise Operations on Binary Images)
Prerequisite: Arithmetic Operations on Images | Set-1Bitwise operations are used in image manipulation and used for extracting essential parts in the image. In this article, Bitwise operations used are : ANDORXORNOT Also, Bitwise operations helps in image masking. Image creation can be enabled with the help of these operations. These operations can
4 min read
NumPy Array Sorting | How to sort NumPy Array
Sorting an array is a very important step in data analysis as it helps in ordering data, and makes it easier to search and clean. In this tutorial, we will learn how to sort an array in NumPy. You can sort an array in NumPy: Using np.sort() functionin-line sortsorting along different axesUsing np.argsort() functionUsing np.lexsort() functionUsing s
4 min read
NumPy ndarray.size() Method | Get Number of Elements in NumPy Array
The ndarray.size() method returns the number of elements in the NumPy array. It works the same as np.prod(a.shape), i.e., the product of the dimensions of the array. Example C/C++ Code import numpy as np arr = np.zeros((3, 4, 2), dtype = np.complex128) gfg = arr.size print (gfg) Output : 24Syntax Syntax: numpy.ndarray.size(arr) Parameters arr : [ar
1 min read
NumPy ndarray.__abs__() | Find Absolute Value of Elements in NumPy Array
The ndarray.__abs__() method returns the absolute value of every element in the NumPy array. It is automatically invoked when we use Python's built-in method abs() on a NumPy array. Example C/C++ Code import numpy as np gfg = np.array([1.45, 2.32, 3.98, 4.41, 5.55, 6.12]) print(gfg.__abs__()) Output[ 1 2 3 4 5 6] SyntaxSyntax: ndarray.__abs__() Ret
1 min read
View More Articles
Article Tags :
Image-Processing
Python-numpy
Python
Practice Tags :
python
three90RightbarBannerImg


geeksforgeeks-footer-logo
A-143, 9th Floor, Sovereign Corporate Tower, Sector-136, Noida, Uttar Pradesh - 201305
GFG App on Play Store
GFG App on App Store
Company
About Us
Legal
In Media
Contact Us
Advertise with us
GFG Corporate Solution
Placement Training Program
GeeksforGeeks Community
Languages
Python
Java
C++
PHP
GoLang
SQL
R Language
Android Tutorial
Tutorials Archive
DSA
Data Structures
Algorithms
DSA for Beginners
Basic DSA Problems
DSA Roadmap
Top 100 DSA Interview Problems
DSA Roadmap by Sandeep Jain
All Cheat Sheets
Data Science & ML
Data Science With Python
Data Science For Beginner
Machine Learning Tutorial
ML Maths
Data Visualisation Tutorial
Pandas Tutorial
NumPy Tutorial
NLP Tutorial
Deep Learning Tutorial
Web Technologies
HTML
CSS
JavaScript
TypeScript
ReactJS
NextJS
Bootstrap
Web Design
Python Tutorial
Python Programming Examples
Python Projects
Python Tkinter
Web Scraping
OpenCV Tutorial
Python Interview Question
Django
Computer Science
Operating Systems
Computer Network
Database Management System
Software Engineering
Digital Logic Design
Engineering Maths
Software Development
Software Testing
DevOps
Git
Linux
AWS
Docker
Kubernetes
Azure
GCP
DevOps Roadmap
System Design
High Level Design
Low Level Design
UML Diagrams
Interview Guide
Design Patterns
OOAD
System Design Bootcamp
Interview Questions
Inteview Preparation
Competitive Programming
Top DS or Algo for CP
Company-Wise Recruitment Process
Company-Wise Preparation
Aptitude Preparation
Puzzles
School Subjects
Mathematics
Physics
Chemistry
Biology
Social Science
English Grammar
Commerce
World GK
GeeksforGeeks Videos
DSA
Python
Java
C++
Web Development
Data Science
CS Subjects
@GeeksforGeeks, Sanchhaya Education Private Limited, All rights reserved
Lightbox